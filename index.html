<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rekap Penjualan Voucher - AGAM.NET</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    h2 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #ffeb3b;
      color: #000;
    }
    input[type="number"] {
      width: 80px;
      padding: 4px;
      text-align: center;
    }
    .btn {
      margin: 8px 4px;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: #fff;
      font-weight: bold;
    }
    .hitung { background: #4caf50; }
    .simpan { background: #ff9800; }
    .export { background: #f44336; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Rekap Penjualan Voucher <br> AGAM.NET</h2>
    
    <label>Tanggal Rekap:</label>
    <input type="date" id="tanggal"><br><br>
    <label>Nama Reseller:</label>
    <input type="text" id="reseller" placeholder="Nama Reseller"><br><br>

    <table>
      <tr>
        <th>JENIS VOUCHER</th>
        <th>QTY</th>
        <th>SISA</th>
        <th>TERJUAL</th>
        <th>JUMLAH BAYAR (Rp)</th>
      </tr>
      <tr>
        <td>2.000</td>
        <td><input type="number" id="qty2000" value="0"></td>
        <td><input type="number" id="sisa2000" value="0"></td>
        <td id="jual2000">0</td>
        <td id="bayar2000">-</td>
      </tr>
      <tr>
        <td>3.000</td>
        <td><input type="number" id="qty3000" value="0"></td>
        <td><input type="number" id="sisa3000" value="0"></td>
        <td id="jual3000">0</td>
        <td id="bayar3000">-</td>
      </tr>
      <tr>
        <td>5.000</td>
        <td><input type="number" id="qty5000" value="0"></td>
        <td><input type="number" id="sisa5000" value="0"></td>
        <td id="jual5000">0</td>
        <td id="bayar5000">-</td>
      </tr>
      <tr>
        <td>20.000</td>
        <td><input type="number" id="qty20000" value="0"></td>
        <td><input type="number" id="sisa20000" value="0"></td>
        <td id="jual20000">0</td>
        <td id="bayar20000">-</td>
      </tr>
      <tr>
        <td>50.000</td>
        <td><input type="number" id="qty50000" value="0"></td>
        <td><input type="number" id="sisa50000" value="0"></td>
        <td id="jual50000">0</td>
        <td id="bayar50000">-</td>
      </tr>
      <tr>
        <th colspan="4">Total</th>
        <th id="totalBayar">-</th>
      </tr>
      <tr>
        <th colspan="4">Komisi Reseller (10%)</th>
        <th id="komisi">-</th>
      </tr>
    </table>

    <div style="text-align:center; margin-top:15px;">
      <button class="btn hitung" onclick="hitung()">HITUNG</button>
      <button class="btn simpan" onclick="simpan()">SIMPAN</button>
      <button class="btn export" onclick="exportExcel()">EXPORT EXCEL</button>
      <button class="btn export" onclick="exportPDF()">EXPORT PDF</button>
    </div>
  </div>

  <script>
    function hitung() {
      let harga = {2000:2000, 3000:3000, 5000:5000, 20000:20000, 50000:50000};
      let total = 0;

      for (let key in harga) {
        let qty = parseInt(document.getElementById("qty"+key).value) || 0;
        let sisa = parseInt(document.getElementById("sisa"+key).value) || 0;
        let terjual = qty - sisa;
        let bayar = terjual * harga[key];

        document.getElementById("jual"+key).innerText = terjual;
        document.getElementById("bayar"+key).innerText = bayar.toLocaleString("id-ID");

        total += bayar;
      }

      document.getElementById("totalBayar").innerText = total.toLocaleString("id-ID");
      document.getElementById("komisi").innerText = (total*0.1).toLocaleString("id-ID");
    }

    function simpan() {
      let data = {
        tanggal: document.getElementById("tanggal").value,
        reseller: document.getElementById("reseller").value,
        qty2000: document.getElementById("qty2000").value,
        sisa2000: document.getElementById("sisa2000").value,
        qty3000: document.getElementById("qty3000").value,
        sisa3000: document.getElementById("sisa3000").value,
        qty5000: document.getElementById("qty5000").value,
        sisa5000: document.getElementById("sisa5000").value,
        qty20000: document.getElementById("qty20000").value,
        sisa20000: document.getElementById("sisa20000").value,
        qty50000: document.getElementById("qty50000").value,
        sisa50000: document.getElementById("sisa50000").value,
        total: document.getElementById("totalBayar").innerText,
        komisi: document.getElementById("komisi").innerText
      };

      fetch("https://script.google.com/macros/s/AKfycbx8SszZW1T3pmoUd29lTADvuuRoIrMsG34Y5SujkgbE6rKwVg865jjTfYmTvvJ1fS4t/exec", {
        method: "POST",
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(txt => {
        alert("Data berhasil disimpan ke Google Sheets!");
        document.querySelectorAll("input").forEach(i => i.value = "0");
        document.getElementById("reseller").value = "";
        document.getElementById("tanggal").value = "";
        document.querySelectorAll("td[id]").forEach(td => td.innerText = "0");
        document.getElementById("totalBayar").innerText = "-";
        document.getElementById("komisi").innerText = "-";
      })
      .catch(err => alert("Error: " + err));
    }

    function exportExcel() {
      alert("Export Excel masih dummy, nanti bisa pakai SheetJS atau backend.");
    }

    function exportPDF() {
      alert("Export PDF masih dummy, nanti bisa pakai jsPDF.");
    }
  </script>
</body>
</html>
